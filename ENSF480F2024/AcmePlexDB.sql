
DROP DATABASE IF EXISTS acmeplexdb;

CREATE DATABASE acmeplexdb;

USE acmeplexdb;

CREATE TABLE CardInfo
    (CardNum     VARCHAR(16)     NOT NULL,
    CardCVV      VARCHAR(3)      NOT NUll,
    CardExp     VARCHAR(4)      NOT NUll,
    CardholderName  VARCHAR(50) NOT NULL,
    PRIMARY KEY (CardNum) );

CREATE TABLE Customers(
    CUsername    VARCHAR(15)    NOT NULL,
    CPassword   VARCHAR(15)     NOT NULL,
    CEmail      VARCHAR(30)     NOT NULL,
    ISRegisteredUser    INT     NOT NULL,
    RName       VARCHAR(50),
    RAddress    VARCHAR(50),
    RCardNo     VARCHAR(16),
        PRIMARY KEY (CEmail),
        UNIQUE (CUsername),
        FOREIGN KEY (RCardNo) REFERENCES CardInfo (CardNum) );
        
CREATE TABLE Admins(
    AUsername    VARCHAR(15)    NOT NULL,
    APassword   VARCHAR(15)     NOT NULL,
    AEmail      VARCHAR(30)     NOT NULL,
        PRIMARY KEY (AEmail),
        UNIQUE (AUsername)
	);

CREATE TABLE Movies (
    MovieTitle  VARCHAR(50)     NOT NULL,
    Duration    INT             NOT NULL,
    PublicReleaseDate   VARCHAR(30)    NOT NULL,
    Director    VARCHAR(20)     NOT NULL,
    Genres      VARCHAR(50),
        PRIMARY KEY (MovieTitle) );

CREATE TABLE Theatres (
    TheatreName VARCHAR(15) NOT NULL,
    NumRooms INT         NOT NULL,
        PRIMARY KEY (TheatreName) );


CREATE TABLE SeatMaps (
    SeatMapID   VARCHAR(15) NOT NULL,
    TheatreName VARCHAR(15) NOT NULL,
    RoomNum INT NOT NULL,
    NumSeats INT NOT NULL,
        PRIMARY KEY (SeatMapID),
        FOREIGN KEY (TheatreName) REFERENCES Theatres (TheatreName) );


CREATE TABLE Showings(
    ShowingID VARCHAR(20)   NOT NULL,
    MovieTitle VARCHAR(50)  NOT NULL,
    TheatreName VARCHAR(15) NOT NULL,
    RoomNum INT             NOT NULL,
    ShowingTime VARCHAR(30)        NOT NULL,
    SeatMapID   VARCHAR(15) NOT NULL,
        PRIMARY KEY (ShowingID),
        FOREIGN KEY (MovieTitle) REFERENCES Movies (MovieTitle),
        FOREIGN KEY (TheatreName) REFERENCES Theatres (TheatreName),
        FOREIGN KEY (SeatMapID) REFERENCES SeatMaps (SeatMapID));
        
CREATE TABLE Seats (
	SeatMapID VARCHAR(15) NOT NULL,
    ShowingID VARCHAR(20) NOT NULL,
    SeatID  VARCHAR(15) NOT NULL, 
    isAvailable BOOLEAN DEFAULT TRUE,
        PRIMARY KEY (SeatID),
        FOREIGN KEY (SeatMapID)   REFERENCES SeatMaps (SeatMapID),
        FOREIGN KEY (ShowingID) REFERENCES Showings (ShowingID) );

CREATE TABLE Tickets(
    TicketID   VARCHAR(16) NOT NULL,
    MovieTitle   VARCHAR(50) NOT NULL,
    TheatreName VARCHAR(15) NOT NULL,
    SeatID     VARCHAR(15)  NOT NULL,
    ShowingTime VARCHAR(30) NOT NULL,
    ShowingID VARCHAR(20) NOT NULL,
    Price       FLOAT       NOT NULL,
    ReceiptID   VARCHAR(15),
        PRIMARY KEY (TicketID),
        FOREIGN KEY (MovieTitle) REFERENCES Movies (MovieTitle),
        FOREIGN Key (TheatreName) REFERENCES Theatres(TheatreName),
        FOREIGN KEY (SeatID)   REFERENCES Seats (SeatID),
        FOREIGN KEY (ShowingID) REFERENCES Showings (ShowingID)
);

CREATE TABLE Receipts (
    ReceiptID   VARCHAR(15)     NOT NULL,
    CustEmail   VARCHAR(30)   NOT NULL,
    CardNum		VARCHAR(16)		NOT NULL,
    TicketID	VARCHAR(16) ,
		PRIMARY KEY (ReceiptID)
    );

CREATE TABLE Orders (
	ReceiptID	VARCHAR(15)	NOT NULL,
    OrderID		VARCHAR(15) NOT NULL,
    TicketID	VARCHAR(16)	NOT NULL,
		FOREIGN KEY (ReceiptID) REFERENCES Receipts (ReceiptID),
        FOREIGN KEY (TicketID) REFERENCES Tickets (TicketID)	
    );
    
INSERT INTO Admins
VALUES
	('admin1', 'apassword1', 'admin@email.com');

INSERT INTO Customers (CUsername, CPassword, CEmail, ISRegisteredUser, RName, RAddress, RCardNo) 
VALUES     ('user1', 'password1', 'user1@email.com', 0, NULL, NULL, NULL),
        ('user2', 'password2', 'user2@email.com', 0, NULL, NULL, NULL),
        ('ruser1', 'rpassword1', 'ruser1@email.com', 0, NULL, NULL, NULL);

INSERT INTO CardInfo VALUES  ('1234123412341234', '123', '0124', 'John Doe');

UPDATE Customers
 SET ISRegisteredUser = 1, RName = 'John Doe', RAddress = '123 Address', RCardNo = 
 (SELECT CardNum FROM CardInfo) WHERE CUsername = 'ruser1';

INSERT INTO Movies 
VALUES 
 ('Bonhoeffer: Pastor. Spy. Assassin.', 132, '2024-12-07', 'Todd Komarnicki', 'Drama'),
 ('Red One', 123, '2024-11-15', ' Jake Kasdan', 'Action');

INSERT INTO Theatres
 VALUES  ('North Hills', 5),
 ('West Valleys',3),
 ('East Plains', 1),
 ('South Summit', 1);


INSERT INTO SeatMaps
VALUES
	('00', 'West Valleys', 1, 66),
    ('01', 'West Valleys', 1, 66),
    ('02', 'West Valleys', 2, 66),
    ('03', 'West Valleys', 2, 66),
    ('04', 'East Plains', 1, 66),
    ('05', 'East Plains', 1, 66)
;

INSERT INTO Showings
VALUES
	('00', 'Bonhoeffer: Pastor. Spy. Assassin.', 'West Valleys', 1, '2024-12-07T12:00:00', '00'),
    ('01', 'Bonhoeffer: Pastor. Spy. Assassin.', 'West Valleys', 1, '2024-12-08T12:00:00', '01'),
    ('02', 'Red One', 'West Valleys', 2, '2024-12-03T12:00:00', '02'),
    ('03', 'Red One', 'West Valleys', 2, '2024-12-03T17:00:00', '03'),
    ('04', 'Red One', 'East Plains', 1, '2024-12-03T14:00:00', '04'),
    ('05', 'Red One', 'East Plains', 1, '2024-12-03T19:00:00', '05')
;

INSERT INTO seats
VALUES
	('00', '00', '0000A1', 1),
    ('00', '00', '0000A2', 1),
    ('00', '00', '0000A3', 1),
    ('00', '00', '0000A4', 1),
    ('00', '00', '0000A5', 1),
    ('00', '00', '0000A6', 1),
    ('00', '00', '0000A7', 1),
    ('00', '00', '0000A8', 1),
    ('00', '00', '0000A9', 1),
    ('00', '00', '0000A10', 1),
    ('00', '00', '0000A11', 1),
	('00', '00', '0000B1', 1),
    ('00', '00', '0000B2', 1),
    ('00', '00', '0000B3', 1),
    ('00', '00', '0000B4', 1),
    ('00', '00', '0000B5', 1),
    ('00', '00', '0000B6', 1),
    ('00', '00', '0000B7', 1),
    ('00', '00', '0000B8', 1),
    ('00', '00', '0000B9', 1),
    ('00', '00', '0000B10', 1),
    ('00', '00', '0000B11', 1),
	('00', '00', '0000C1', 1),
    ('00', '00', '0000C2', 1),
    ('00', '00', '0000C3', 1),
    ('00', '00', '0000C4', 1),
    ('00', '00', '0000C5', 1),
    ('00', '00', '0000C6', 1),
    ('00', '00', '0000C7', 1),
    ('00', '00', '0000C8', 1),
    ('00', '00', '0000C9', 1),
    ('00', '00', '0000C10', 1),
    ('00', '00', '0000C11', 1),
	('00', '00', '0000D1', 1),
    ('00', '00', '0000D2', 1),
    ('00', '00', '0000D3', 1),
    ('00', '00', '0000D4', 1),
    ('00', '00', '0000D5', 1),
    ('00', '00', '0000D6', 1),
    ('00', '00', '0000D7', 1),
    ('00', '00', '0000D8', 1),
    ('00', '00', '0000D9', 1),
    ('00', '00', '0000D10', 1),
    ('00', '00', '0000D11', 1),
	('00', '00', '0000E1', 1),
    ('00', '00', '0000E2', 1),
    ('00', '00', '0000E3', 1),
    ('00', '00', '0000E4', 1),
    ('00', '00', '0000E5', 1),
    ('00', '00', '0000E6', 1),
    ('00', '00', '0000E7', 1),
    ('00', '00', '0000E8', 1),
    ('00', '00', '0000E9', 1),
    ('00', '00', '0000E10', 1),
    ('00', '00', '0000E11', 1),
	('00', '00', '0000F1', 1),
    ('00', '00', '0000F2', 1),
    ('00', '00', '0000F3', 1),
    ('00', '00', '0000F4', 1),
    ('00', '00', '0000F5', 1),
    ('00', '00', '0000F6', 1),
    ('00', '00', '0000F7', 1),
    ('00', '00', '0000F8', 1),
    ('00', '00', '0000F9', 1),
    ('00', '00', '0000F10', 1),
    ('00', '00', '0000F11', 1)
;

INSERT INTO seats
VALUES
	('01', '01', '0101A1', 1),
    ('01', '01', '0101A2', 1),
    ('01', '01', '0101A3', 1),
    ('01', '01', '0101A4', 1),
    ('01', '01', '0101A5', 1),
    ('01', '01', '0101A6', 1),
    ('01', '01', '0101A7', 1),
    ('01', '01', '0101A8', 1),
    ('01', '01', '0101A9', 1),
    ('01', '01', '0101A10', 1),
    ('01', '01', '0101A11', 1),
	('01', '01', '0101B1', 1),
    ('01', '01', '0101B2', 1),
    ('01', '01', '0101B3', 1),
    ('01', '01', '0101B4', 1),
    ('01', '01', '0101B5', 1),
    ('01', '01', '0101B6', 1),
    ('01', '01', '0101B7', 1),
    ('01', '01', '0101B8', 1),
    ('01', '01', '0101B9', 1),
    ('01', '01', '0101B10', 1),
    ('01', '01', '0101B11', 1),
	('01', '01', '0101C1', 1),
    ('01', '01', '0101C2', 1),
    ('01', '01', '0101C3', 1),
    ('01', '01', '0101C4', 1),
    ('01', '01', '0101C5', 1),
    ('01', '01', '0101C6', 1),
    ('01', '01', '0101C7', 1),
    ('01', '01', '0101C8', 1),
    ('01', '01', '0101C9', 1),
    ('01', '01', '0101C10', 1),
    ('01', '01', '0101C11', 1),
	('01', '01', '0101D1', 1),
    ('01', '01', '0101D2', 1),
    ('01', '01', '0101D3', 1),
    ('01', '01', '0101D4', 1),
    ('01', '01', '0101D5', 1),
    ('01', '01', '0101D6', 1),
    ('01', '01', '0101D7', 1),
    ('01', '01', '0101D8', 1),
    ('01', '01', '0101D9', 1),
    ('01', '01', '0101D10', 1),
    ('01', '01', '0101D11', 1),
	('01', '01', '0101E1', 1),
    ('01', '01', '0101E2', 1),
    ('01', '01', '0101E3', 1),
    ('01', '01', '0101E4', 1),
    ('01', '01', '0101E5', 1),
    ('01', '01', '0101E6', 1),
    ('01', '01', '0101E7', 1),
    ('01', '01', '0101E8', 1),
    ('01', '01', '0101E9', 1),
    ('01', '01', '0101E10', 1),
    ('01', '01', '0101E11', 1),
	('01', '01', '0101F1', 1),
    ('01', '01', '0101F2', 1),
    ('01', '01', '0101F3', 1),
    ('01', '01', '0101F4', 1),
    ('01', '01', '0101F5', 1),
    ('01', '01', '0101F6', 1),
    ('01', '01', '0101F7', 1),
    ('01', '01', '0101F8', 1),
    ('01', '01', '0101F9', 1),
    ('01', '01', '0101F10', 1),
    ('01', '01', '0101F11', 1)
   
;


INSERT INTO seats
VALUES
	('02', '02', '0202A1', 1),
    ('02', '02', '0202A2', 1),
    ('02', '02', '0202A3', 1),
    ('02', '02', '0202A4', 1),
    ('02', '02', '0202A5', 1),
    ('02', '02', '0202A6', 1),
    ('02', '02', '0202A7', 1),
    ('02', '02', '0202A8', 1),
    ('02', '02', '0202A9', 1),
    ('02', '02', '0202A10', 1),
    ('02', '02', '0202A11', 1),
	('02', '02', '0202B1', 1),
    ('02', '02', '0202B2', 1),
    ('02', '02', '0202B3', 1),
    ('02', '02', '0202B4', 1),
    ('02', '02', '0202B5', 1),
    ('02', '02', '0202B6', 1),
    ('02', '02', '0202B7', 1),
    ('02', '02', '0202B8', 1),
    ('02', '02', '0202B9', 1),
    ('02', '02', '0202B10', 1),
    ('02', '02', '0202B11', 1),
	('02', '02', '0202C1', 1),
    ('02', '02', '0202C2', 1),
    ('02', '02', '0202C3', 1),
    ('02', '02', '0202C4', 1),
    ('02', '02', '0202C5', 1),
    ('02', '02', '0202C6', 1),
    ('02', '02', '0202C7', 1),
    ('02', '02', '0202C8', 1),
    ('02', '02', '0202C9', 1),
    ('02', '02', '0202C10', 1),
    ('02', '02', '0202C11', 1),
	('02', '02', '0202D1', 1),
    ('02', '02', '0202D2', 1),
    ('02', '02', '0202D3', 1),
    ('02', '02', '0202D4', 1),
    ('02', '02', '0202D5', 1),
    ('02', '02', '0202D6', 1),
    ('02', '02', '0202D7', 1),
    ('02', '02', '0202D8', 1),
    ('02', '02', '0202D9', 1),
    ('02', '02', '0202D10', 1),
    ('02', '02', '0202D11', 1),
	('02', '02', '0202E1', 1),
    ('02', '02', '0202E2', 1),
    ('02', '02', '0202E3', 1),
    ('02', '02', '0202E4', 1),
    ('02', '02', '0202E5', 1),
    ('02', '02', '0202E6', 1),
    ('02', '02', '0202E7', 1),
    ('02', '02', '0202E8', 1),
    ('02', '02', '0202E9', 1),
    ('02', '02', '0202E10', 1),
    ('02', '02', '0202E11', 1),
	('02', '02', '0202F1', 1),
    ('02', '02', '0202F2', 1),
    ('02', '02', '0202F3', 1),
    ('02', '02', '0202F4', 1),
    ('02', '02', '0202F5', 1),
    ('02', '02', '0202F6', 1),
    ('02', '02', '0202F7', 1),
    ('02', '02', '0202F8', 1),
    ('02', '02', '0202F9', 1),
    ('02', '02', '0202F10', 1),
    ('02', '02', '0202F11', 1)
   
;

INSERT INTO seats
VALUES
	('03', '03', '0303A1', 1),
    ('03', '03', '0303A2', 1),
    ('03', '03', '0303A3', 1),
    ('03', '03', '0303A4', 1),
    ('03', '03', '0303A5', 1),
    ('03', '03', '0303A6', 1),
    ('03', '03', '0303A7', 1),
    ('03', '03', '0303A8', 1),
    ('03', '03', '0303A9', 1),
    ('03', '03', '0303A10', 1),
    ('03', '03', '0303A11', 1),
	('03', '03', '0303B1', 1),
    ('03', '03', '0303B2', 1),
    ('03', '03', '0303B3', 1),
    ('03', '03', '0303B4', 1),
    ('03', '03', '0303B5', 1),
    ('03', '03', '0303B6', 1),
    ('03', '03', '0303B7', 1),
    ('03', '03', '0303B8', 1),
    ('03', '03', '0303B9', 1),
    ('03', '03', '0303B10', 1),
    ('03', '03', '0303B11', 1),
	('03', '03', '0303C1', 1),
    ('03', '03', '0303C2', 1),
    ('03', '03', '0303C3', 1),
    ('03', '03', '0303C4', 1),
    ('03', '03', '0303C5', 1),
    ('03', '03', '0303C6', 1),
    ('03', '03', '0303C7', 1),
    ('03', '03', '0303C8', 1),
    ('03', '03', '0303C9', 1),
    ('03', '03', '0303C10', 1),
    ('03', '03', '0303C11', 1),
	('03', '03', '0303D1', 1),
    ('03', '03', '0303D2', 1),
    ('03', '03', '0303D3', 1),
    ('03', '03', '0303D4', 1),
    ('03', '03', '0303D5', 1),
    ('03', '03', '0303D6', 1),
    ('03', '03', '0303D7', 1),
    ('03', '03', '0303D8', 1),
    ('03', '03', '0303D9', 1),
    ('03', '03', '0303D10', 1),
    ('03', '03', '0303D11', 1),
	('03', '03', '0303E1', 1),
    ('03', '03', '0303E2', 1),
    ('03', '03', '0303E3', 1),
    ('03', '03', '0303E4', 1),
    ('03', '03', '0303E5', 1),
    ('03', '03', '0303E6', 1),
    ('03', '03', '0303E7', 1),
    ('03', '03', '0303E8', 1),
    ('03', '03', '0303E9', 1),
    ('03', '03', '0303E10', 1),
    ('03', '03', '0303E11', 1),
	('03', '03', '0303F1', 1),
    ('03', '03', '0303F2', 1),
    ('03', '03', '0303F3', 1),
    ('03', '03', '0303F4', 1),
    ('03', '03', '0303F5', 1),
    ('03', '03', '0303F6', 1),
    ('03', '03', '0303F7', 1),
    ('03', '03', '0303F8', 1),
    ('03', '03', '0303F9', 1),
    ('03', '03', '0303F10', 1),
    ('03', '03', '0303F11', 1)
   
;

INSERT INTO seats
VALUES
	('04', '04', '0404A1', 1),
    ('04', '04', '0404A2', 1),
    ('04', '04', '0404A3', 1),
    ('04', '04', '0404A4', 1),
    ('04', '04', '0404A5', 1),
    ('04', '04', '0404A6', 1),
    ('04', '04', '0404A7', 1),
    ('04', '04', '0404A8', 1),
    ('04', '04', '0404A9', 1),
    ('04', '04', '0404A10', 1),
    ('04', '04', '0404A11', 1),
	('04', '04', '0404B1', 1),
    ('04', '04', '0404B2', 1),
    ('04', '04', '0404B3', 1),
    ('04', '04', '0404B4', 1),
    ('04', '04', '0404B5', 1),
    ('04', '04', '0404B6', 1),
    ('04', '04', '0404B7', 1),
    ('04', '04', '0404B8', 1),
    ('04', '04', '0404B9', 1),
    ('04', '04', '0404B10', 1),
    ('04', '04', '0404B11', 1),
	('04', '04', '0404C1', 1),
    ('04', '04', '0404C2', 1),
    ('04', '04', '0404C3', 1),
    ('04', '04', '0404C4', 1),
    ('04', '04', '0404C5', 1),
    ('04', '04', '0404C6', 1),
    ('04', '04', '0404C7', 1),
    ('04', '04', '0404C8', 1),
    ('04', '04', '0404C9', 1),
    ('04', '04', '0404C10', 1),
    ('04', '04', '0404C11', 1),
	('04', '04', '0404D1', 1),
    ('04', '04', '0404D2', 1),
    ('04', '04', '0404D3', 1),
    ('04', '04', '0404D4', 1),
    ('04', '04', '0404D5', 1),
    ('04', '04', '0404D6', 1),
    ('04', '04', '0404D7', 1),
    ('04', '04', '0404D8', 1),
    ('04', '04', '0404D9', 1),
    ('04', '04', '0404D10', 1),
    ('04', '04', '0404D11', 1),
	('04', '04', '0404E1', 1),
    ('04', '04', '0404E2', 1),
    ('04', '04', '0404E3', 1),
    ('04', '04', '0404E4', 1),
    ('04', '04', '0404E5', 1),
    ('04', '04', '0404E6', 1),
    ('04', '04', '0404E7', 1),
    ('04', '04', '0404E8', 1),
    ('04', '04', '0404E9', 1),
    ('04', '04', '0404E10', 1),
    ('04', '04', '0404E11', 1),
	('04', '04', '0404F1', 1),
    ('04', '04', '0404F2', 1),
    ('04', '04', '0404F3', 1),
    ('04', '04', '0404F4', 1),
    ('04', '04', '0404F5', 1),
    ('04', '04', '0404F6', 1),
    ('04', '04', '0404F7', 1),
    ('04', '04', '0404F8', 1),
    ('04', '04', '0404F9', 1),
    ('04', '04', '0404F10', 1),
    ('04', '04', '0404F11', 1)
   
;

INSERT INTO seats
VALUES
	('05', '05', '0505A1', 1),
    ('05', '05', '0505A2', 1),
    ('05', '05', '0505A3', 1),
    ('05', '05', '0505A4', 1),
    ('05', '05', '0505A5', 1),
    ('05', '05', '0505A6', 1),
    ('05', '05', '0505A7', 1),
    ('05', '05', '0505A8', 1),
    ('05', '05', '0505A9', 1),
    ('05', '05', '0505A10', 1),
    ('05', '05', '0505A11', 1),
	('05', '05', '0505B1', 1),
    ('05', '05', '0505B2', 1),
    ('05', '05', '0505B3', 1),
    ('05', '05', '0505B4', 1),
    ('05', '05', '0505B5', 1),
    ('05', '05', '0505B6', 1),
    ('05', '05', '0505B7', 1),
    ('05', '05', '0505B8', 1),
    ('05', '05', '0505B9', 1),
    ('05', '05', '0505B10', 1),
    ('05', '05', '0505B11', 1),
	('05', '05', '0505C1', 1),
    ('05', '05', '0505C2', 1),
    ('05', '05', '0505C3', 1),
    ('05', '05', '0505C4', 1),
    ('05', '05', '0505C5', 1),
    ('05', '05', '0505C6', 1),
    ('05', '05', '0505C7', 1),
    ('05', '05', '0505C8', 1),
    ('05', '05', '0505C9', 1),
    ('05', '05', '0505C10', 1),
    ('05', '05', '0505C11', 1),
	('05', '05', '0505D1', 1),
    ('05', '05', '0505D2', 1),
    ('05', '05', '0505D3', 1),
    ('05', '05', '0505D4', 1),
    ('05', '05', '0505D5', 1),
    ('05', '05', '0505D6', 1),
    ('05', '05', '0505D7', 1),
    ('05', '05', '0505D8', 1),
    ('05', '05', '0505D9', 1),
    ('05', '05', '0505D10', 1),
    ('05', '05', '0505D11', 1),
	('05', '05', '0505E1', 1),
    ('05', '05', '0505E2', 1),
    ('05', '05', '0505E3', 1),
    ('05', '05', '0505E4', 1),
    ('05', '05', '0505E5', 1),
    ('05', '05', '0505E6', 1),
    ('05', '05', '0505E7', 1),
    ('05', '05', '0505E8', 1),
    ('05', '05', '0505E9', 1),
    ('05', '05', '0505E10', 1),
    ('05', '05', '0505E11', 1),
	('05', '05', '0505F1', 1),
    ('05', '05', '0505F2', 1),
    ('05', '05', '0505F3', 1),
    ('05', '05', '0505F4', 1),
    ('05', '05', '0505F5', 1),
    ('05', '05', '0505F6', 1),
    ('05', '05', '0505F7', 1),
    ('05', '05', '0505F8', 1),
    ('05', '05', '0505F9', 1),
    ('05', '05', '0505F10', 1),
    ('05', '05', '0505F11', 1)
   
;

